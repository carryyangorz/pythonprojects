import re
import json
import requests
from openpyxl import Workbook
headers={
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36'
}

a='{"name":"Potentilla reptans","author":"L.","family":"Rosaceae","commonNames":["Creeping Cinquefoil"],"images":[{"id":"c15f6f1e520c46e68f4c959fdc577e2d96bdfed0","o":"https://bs.plantnet.org/image/o/c15f6f1e520c46e68f4c959fdc577e2d96bdfed0","m":"https://bs.plantnet.org/image/m/c15f6f1e520c46e68f4c959fdc577e2d96bdfed0","s":"https://bs.plantnet.org/image/s/c15f6f1e520c46e68f4c959fdc577e2d96bdfed0"},{"id":"86c2458ca3077047e625dab359be612e8a2be0eb","o":"https://bs.plantnet.org/image/o/86c2458ca3077047e625dab359be612e8a2be0eb","m":"https://bs.plantnet.org/image/m/86c2458ca3077047e625dab359be612e8a2be0eb","s":"https://bs.plantnet.org/image/s/86c2458ca3077047e625dab359be612e8a2be0eb"},{"id":"18ca7438aa2574442d0067e27524dbdf6ac65ddc","o":"https://bs.plantnet.org/image/o/18ca7438aa2574442d0067e27524dbdf6ac65ddc","m":"https://bs.plantnet.org/image/m/18ca7438aa2574442d0067e27524dbdf6ac65ddc","s":"https://bs.plantnet.org/image/s/18ca7438aa2574442d0067e27524dbdf6ac65ddc"},{"id":"508e78dbc62c21f3d4b29d281f81e98998f513ce","o":"https://bs.plantnet.org/image/o/508e78dbc62c21f3d4b29d281f81e98998f513ce","m":"https://bs.plantnet.org/image/m/508e78dbc62c21f3d4b29d281f81e98998f513ce","s":"https://bs.plantnet.org/image/s/508e78dbc62c21f3d4b29d281f81e98998f513ce"}],"imagesCount":8513,"observationsCount":7048,"tags":[],"iucn":null,"searchTerms":"rosaceae potentilla reptans creeping cinquefoil"},{"name":"Agrimonia eupatoria","author":"L.","family":"Rosaceae","commonNames":["Agrimony"],"images":[{"id":"35a2e338466068f8636c1764b8d31f6298dee718","o":"https://bs.plantnet.org/image/o/35a2e338466068f8636c1764b8d31f6298dee718","m":"https://bs.plantnet.org/image/m/35a2e338466068f8636c1764b8d31f6298dee718","s":"https://bs.plantnet.org/image/s/35a2e338466068f8636c1764b8d31f6298dee718"},{"id":"9d1e3d2a936c8e7c81a6d7a79146f2d73223faff","o":"https://bs.plantnet.org/image/o/9d1e3d2a936c8e7c81a6d7a79146f2d73223faff","m":"https://bs.plantnet.org/image/m/9d1e3d2a936c8e7c81a6d7a79146f2d73223faff","s":"https://bs.plantnet.org/image/s/9d1e3d2a936c8e7c81a6d7a79146f2d73223faff"},{"id":"790a3c05ca02dad1b9dcb6e6b35c6443f17778dd","o":"https://bs.plantnet.org/image/o/790a3c05ca02dad1b9dcb6e6b35c6443f17778dd","m":"https://bs.plantnet.org/image/m/790a3c05ca02dad1b9dcb6e6b35c6443f17778dd","s":"https://bs.plantnet.org/image/s/790a3c05ca02dad1b9dcb6e6b35c6443f17778dd"},{"id":"fe2d728787ed664e50806b02da02a04f05ba9824","o":"https://bs.plantnet.org/image/o/fe2d728787ed664e50806b02da02a04f05ba9824","m":"https://bs.plantnet.org/image/m/fe2d728787ed664e50806b02da02a04f05ba9824","s":"https://bs.plantnet.org/image/s/fe2d728787ed664e50806b02da02a04f05ba9824"}],"imagesCount":8512,"observationsCount":6145,"tags":[],"iucn":null,"searchTerms":"rosaceae agrimonia eupatoria agrimony"},{"name":"Dianthus barbatus","author":"L.","family":"Caryophyllaceae","commonNames":["Sweet William"],"images":[{"id":"8b344de0f83ee2d3d7a56e42b215e22f5e0acb31","o":"https://bs.plantnet.org/image/o/8b344de0f83ee2d3d7a56e42b215e22f5e0acb31","m":"https://bs.plantnet.org/image/m/8b344de0f83ee2d3d7a56e42b215e22f5e0acb31","s":"https://bs.plantnet.org/image/s/8b344de0f83ee2d3d7a56e42b215e22f5e0acb31"},{"id":"8f0d122bf70a147c5ca1728274e9c380e8e1ba11","o":"https://bs.plantnet.org/image/o/8f0d122bf70a147c5ca1728274e9c380e8e1ba11","m":"https://bs.plantnet.org/image/m/8f0d122bf70a147c5ca1728274e9c380e8e1ba11","s":"https://bs.plantnet.org/image/s/8f0d122bf70a147c5ca1728274e9c380e8e1ba11"},{"id":"bc4b17cb56ca118faa6c64f9c68cd5292dac4d15","o":"https://bs.plantnet.org/image/o/bc4b17cb56ca118faa6c64f9c68cd5292dac4d15","m":"https://bs.plantnet.org/image/m/bc4b17cb56ca118faa6c64f9c68cd5292dac4d15","s":"https://bs.plantnet.org/image/s/bc4b17cb56ca118faa6c64f9c68cd5292dac4d15"},{"id":"9548c3daa82eb9bc8b1154395895ebef3571a7eb","o":"https://bs.plantnet.org/image/o/9548c3daa82eb9bc8b1154395895ebef3571a7eb","m":"https://bs.plantnet.org/image/m/9548c3daa82eb9bc8b1154395895ebef3571a7eb","s":"https://bs.plantnet.org/image/s/9548c3daa82eb9bc8b1154395895ebef3571a7eb"}],"imagesCount":8506,"observationsCount":7562,"tags":[],"iucn":null,"searchTerms":"caryophyllaceae dianthus barbatus sweet william"},{"name":"Celtis australis","author":"L.","family":"Ulmaceae","commonNames":["European hackberry"],"images":[{"id":"026c4c591ef30097e23c2945e49595aa7b8e7910","o":"https://bs.plantnet.org/image/o/026c4c591ef30097e23c2945e49595aa7b8e7910","m":"https://bs.plantnet.org/image/m/026c4c591ef30097e23c2945e49595aa7b8e7910","s":"https://bs.plantnet.org/image/s/026c4c591ef30097e23c2945e49595aa7b8e7910"},{"id":"70fe1a89ce5410e'
b='[{"name":"Viola bicolor","author":"Pursh","family":"Violaceae","commonNames":["Field pansy"],"images":[{"id":"09ced277f67530514d2b1d3486ed56f30be5b7d7","o":"https://bs.plantnet.org/image/o/09ced277f67530514d2b1d3486ed56f30be5b7d7","m":"https://bs.plantnet.org/image/m/09ced277f67530514d2b1d3486ed56f30be5b7d7","s":"https://bs.plantnet.org/image/s/09ced277f67530514d2b1d3486ed56f30be5b7d7"},{"id":"fec2aad2f83e7e8bcebc54acc71ab87df738fbd8","o":"https://bs.plantnet.org/image/o/fec2aad2f83e7e8bcebc54acc71ab87df738fbd8","m":"https://bs.plantnet.org/image/m/fec2aad2f83e7e8bcebc54acc71ab87df738fbd8","s":"https://bs.plantnet.org/image/s/fec2aad2f83e7e8bcebc54acc71ab87df738fbd8"},{"id":"4e7f45f9c25e3d943b62ea2d8738191480126da5","o":"https://bs.plantnet.org/image/o/4e7f45f9c25e3d943b62ea2d8738191480126da5","m":"https://bs.plantnet.org/image/m/4e7f45f9c25e3d943b62ea2d8738191480126da5","s":"https://bs.plantnet.org/image/s/4e7f45f9c25e3d943b62ea2d8738191480126da5"},{"id":"3c0b0b1bee52e5027e8cdbc76952c6cf5d9f0b39","o":"https://bs.plantnet.org/image/o/3c0b0b1bee52e5027e8cdbc76952c6cf5d9f0b39","m":"https://bs.plantnet.org/image/m/3c0b0b1bee52e5027e8cdbc76952c6cf5d9f0b39","s":"https://bs.plantnet.org/image/s/3c0b0b1bee52e5027e8cdbc76952c6cf5d9f0b39"}],"imagesCount":191,"observationsCount":177,"tags":[],"iucn":null,"searchTerms":"violaceae viola bicolor field pansy"},{"name":"Scolymus maculatus","author":"L.","family":"Asteraceae","commonNames":["Spotted goldenthistle"],"images":[{"id":"4bfd34628098325b079eb8b6173e4c4bf2ba9996","o":"https://bs.plantnet.org/image/o/4bfd34628098325b079eb8b6173e4c4bf2ba9996","m":"https://bs.plantnet.org/image/m/4bfd34628098325b079eb8b6173e4c4bf2ba9996","s":"https://bs.plantnet.org/image/s/4bfd34628098325b079eb8b6173e4c4bf2ba9996"},{"id":"1bb952d56a69a95d2fffb6d8dd0117c8826d5eed","o":"https://bs.plantnet.org/image/o/1bb952d56a69a95d2fffb6d8dd0117c8826d5eed","m":"https://bs.plantnet.org/image/m/1bb952d56a69a95d2fffb6d8dd0117c8826d5eed","s":"https://bs.plantnet.org/image/s/1bb952d56a69a95d2fffb6d8dd0117c8826d5eed"},{"id":"0214cfba5412c1bf03ebd266e6ad804f3e08cecf","o":"https://bs.plantnet.org/image/o/0214cfba5412c1bf03ebd266e6ad804f3e08cecf","m":"https://bs.plantnet.org/image/m/0214cfba5412c1bf03ebd266e6ad804f3e08cecf","s":"https://bs.plantnet.org/image/s/0214cfba5412c1bf03ebd266e6ad804f3e08cecf"},{"id":"2f6c64e5e1f77104fbf61589f63b9e570d60a25e","o":"https://bs.plantnet.org/image/o/2f6c64e5e1f77104fbf61589f63b9e570d60a25e","m":"https://bs.plantnet.org/image/m/2f6c64e5e1f77104fbf61589f63b9e570d60a25e","s":"https://bs.plantnet.org/image/s/2f6c64e5e1f77104fbf61589f63b9e570d60a25e"}],"imagesCount":191,"observationsCount":110,"tags":[],"iucn":null,"searchTerms":"asteraceae scolymus maculatus spotted goldenthistle"},{"name":"Phytolacca bogotensis","author":"Kunth","family":"Phytolaccaceae","commonNames":["Southern pokeweed"],"images":[{"id":"cb868498fa2038112a5139276dfd0cfe8d09cbb7","o":"https://bs.plantnet.org/image/o/cb868498fa2038112a5139276dfd0cfe8d09cbb7","m":"https://bs.plantnet.org/image/m/cb868498fa2038112a5139276dfd0cfe8d09cbb7","s":"https://bs.plantnet.org/image/s/cb868498fa2038112a5139276dfd0cfe8d09cbb7"},{"id":"f26a380f5b641f412aab5edfe257dfab37950a63","o":"https://bs.plantnet.org/image/o/f26a380f5b641f412aab5edfe257dfab37950a63","m":"https://bs.plantnet.org/image/m/f26a380f5b641f412aab5edfe257dfab37950a63","s":"https://bs.plantnet.org/image/s/f26a380f5b641f412aab5edfe257dfab37950a63"},{"id":"9b6d5bc9c2df275a24f80d9525cdb69b2deac875","o":"https://bs.plantnet.org/image/o/9b6d5bc9c2df275a24f80d9525cdb69b2deac875","m":"https://bs.plantnet.org/image/m/9b6d5bc9c2df275a24f80d9525cdb69b2deac875","s":"https://bs.plantnet.org/image/s/9b6d5bc9c2df275a24f80d9525cdb69b2deac875"},{"id":"4f709cce165b6a039a13e0a5fb0cf08ba2043d18","o":"https://bs.plantnet.org/image/o/4f709cce165b6a039a13e0a5fb0cf08ba2043d18","m":"https://bs.plantnet.org/image/m/4f709cce165b6a039a13e0a5fb0cf08ba2043d18","s":"https://bs.plantnet.org/image/s/4f709cce165b6a039a13e0a5fb0cf08ba2043d18"}],"imagesCount":191,"observationsCount":151,"tags":[],"iucn":null,"searchTerms":"phytolaccaceae phytolacca bogotensis southern pokeweed"},'
url='https://api.inaturalist.org/v1/search?callback=placeAutocompleteCallback&q=lu&per_page=10&sources=places'
speciesurl='https://api.inaturalist.org/v1/observations/species_counts?verifiable=true&spam=false&place_id=8147&iconic_taxa%5B%5D=Aves&iconic_taxa%5B%5D=unknown&locale=zh-CN&page=2&per_page=50'

# r=requests.get(speciesurl,headers=headers)
# # ccc=re.findall('"matches":\["(.*?)"',r.text)
# # print(ccc)
# aaa=re.findall('id":(.*?),"uuid',r.text)
# bbb=re.findall('("count":.*?)"english_common_name',r.text)
# latin=re.findall('name":"(.*?)","rank',bbb[0])
# chinese=re.findall('preferred_common_name":"(.*?)"',bbb[0])
# photo=re.findall('"count":(.*?),"taxon',bbb[0])
# print(latin)
# print(chinese)
# print(photo)
# for item in aaa:
#     #print(item)
#     name=re.findall('":"(.*?)","auth',item)
#     auth=re.findall('author":"(.*?)"',item)
#     commonname=re.findall('commonNames":\["(.*?)"',item)
#     photo=re.findall('imagesCount":(.*?),"',item)
#     observation=re.findall('observationsCount":(.*?),"',item)
#     family=re.findall('family":"(.*?)"',item)
#     print(name)
#     print(auth)
#     print(commonname)
#     print(observation)
#     print(family)

wb=Workbook()
ws=wb.active
ws.title='Sheet22'
ws.append([1,2,3])

wb.save('test.xlsx')